# Firebase Functions for Sahhel

## ๐ Functions ุงููุชููุฑุฉ

### 1. **ุฅูููู ุชุฑุญูุจู** (`sendWelcomeEmail`)
- ูุดุชุบู ุชููุงุฆูุงู ููุง ูุณุฌู ูุณุชุฎุฏู ุฌุฏูุฏ
- ูุฑุณู ุฅูููู ุชุฑุญูุจู ุจุงูุนุฑุจูุฉ

### 2. **ุฅูุดุงุก ูุณุชูุฏ ุงููุณุชุฎุฏู** (`createUserDocument`)
- ููุดุฆ ูุณุชูุฏ ูู Firestore ุนูุฏ ุงูุชุณุฌูู
- ูุญูุธ ุงูุจูุงูุงุช ุงูุฃูููุฉ ูุงูุฅุญุตุงุฆูุงุช

### 3. **ุชุญุฏูุซ ุฅุญุตุงุฆูุงุช ุงูุงุฎุชุจุงุฑ** (`onQuizCompleted`)
- ูุญุฏุซ ุฅุญุตุงุฆูุงุช ุงููุณุชุฎุฏู ุชููุงุฆูุงู ุนูุฏ ุฅููุงู ุงุฎุชุจุงุฑ

### 4. **ุชุญุฏูุซ ุขุฎุฑ ุชุณุฌูู ุฏุฎูู** (`updateLastLogin`)
- ูุญุฏุซ ููุช ุขุฎุฑ ุชุณุฌูู ุฏุฎูู

### 5. **ุชูุธูู ุงูุจูุงูุงุช ุงููุฏููุฉ** (`cleanupOldData`)
- ูููุฉ ูุฌุฏููุฉ ูู 7 ุฃูุงู
- ุชุญุฐู ูุชุงุฆุฌ ุงูุงุฎุชุจุงุฑุงุช ุงูุฃูุฏู ูู 6 ุฃุดูุฑ

### 6. **HTTP Function ููุงุฎุชุจุงุฑ** (`helloWorld`)
- ููุงุฎุชุจุงุฑ ููุท
- ุฑุงุจุท: `https://REGION-sahhel-org.cloudfunctions.net/helloWorld`

---

## โ๏ธ ุงูุฅุนุฏุงุฏ

### 1. ุฅุนุฏุงุฏ ุฅูููู Gmail (ููุฅููููุงุช):

```bash
# ุฅุนุฏุงุฏ Secrets (ุงูุทุฑููุฉ ุงูุฌุฏูุฏุฉ)
npx firebase functions:secrets:set EMAIL_USER
npx firebase functions:secrets:set EMAIL_PASS
```

**ููุงุญุธุฉ:** 
- ุงุณุชุฎุฏู App Password ูู Gmail (ูู ูููุฉ ุงููุฑูุฑ ุงูุนุงุฏูุฉ)
- ุนูุฏ ุงูุทูุจุ ุฃุฏุฎู ุงูุฅูููู ููููุฉ ุงููุฑูุฑ

### 2. ูุดุฑ Functions:

```bash
npx firebase deploy --only functions
```

---

## ๐ ููุงุญุธุงุช

- **ุงูุฅููููุงุช:** ุชุญุชุงุฌ ุฅุนุฏุงุฏ Gmail App Password
- **ุงูุชูุงููู:** Firebase Functions ูุฌุงููุฉ ุญุชู 2 ููููู ุงุณุชุฏุนุงุก/ุดูุฑ
- **ุงูุชูููุช:** ุงูููุงู ุงููุฌุฏููุฉ ุชุดุชุบู ุญุณุจ ุชูููุช ุงูุฑูุงุถ (Asia/Riyadh)

---

## ๐ง ุงูุชุทููุฑ ุงููุญูู

```bash
# ุชุดุบูู Functions ูุญููุงู
cd functions
npm run serve
```

---

**ุขุฎุฑ ุชุญุฏูุซ:** 2025-01-15
